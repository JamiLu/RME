"use strict";function _get(){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get.bind()}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(arguments.length<3?target:receiver)}return desc.value}}return _get.apply(this,arguments)}function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break}return object}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});Object.defineProperty(subClass,"prototype",{writable:false});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}else if(call!==void 0){throw new TypeError("Derived constructors may only return object or undefined")}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function _regeneratorRuntime(){return exports};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value},$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function define(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,"_invoke",{value:makeInvokeMethod(innerFn,self,context)}),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,function(){return this});var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach(function(method){define(prototype,method,function(arg){return this._invoke(method,arg)})})}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==_typeof(value)&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then(function(value){invoke("next",value,resolve,reject)},function(err){invoke("throw",err,resolve,reject)}):PromiseImpl.resolve(value).then(function(unwrapped){result.value=unwrapped,resolve(result)},function(error){return invoke("throw",error,resolve,reject)})}reject(record.arg)}var previousPromise;defineProperty(this,"_invoke",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl(function(resolve,reject){invoke(method,arg,resolve,reject)})}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg)}}}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(undefined===method)return context.delegate=null,"throw"===methodName&&delegate.iterator["return"]&&(context.method="return",context.arg=undefined,maybeInvokeDelegate(delegate,context),"throw"===context.method)||"return"!==methodName&&(context.method="throw",context.arg=new TypeError("The iterator does not provide a '"+methodName+"' method")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=undefined),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=undefined,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:undefined,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,function(){return this}),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then(function(result){return result.done?result.value:iter.next()})},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,function(){return this}),define(Gp,"toString",function(){return"[object Generator]"}),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=undefined)},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=undefined),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},"catch":function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName:resultName,nextLoc:nextLoc},"next"===this.method&&(this.arg=undefined),ContinueSentinel}},exports}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i["return"]&&(_r=_i["return"](),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var Util=function(){function Util(){_classCallCheck(this,Util)}_createClass(Util,null,[{key:"isEmpty",value:function isEmpty(value){return value===null||value===undefined||Util.isString(value)&&value===""||Util.isObject(value)&&Object.keys(value).length===0||Util.isArray(value)&&value.length===0}},{key:"notEmpty",value:function notEmpty(value){return!Util.isEmpty(value)}},{key:"getType",value:function getType(value){return _typeof(value)}},{key:"isType",value:function isType(value,type){return Util.getType(value)===type}},{key:"isFunction",value:function isFunction(func){return Util.isType(func,"function")}},{key:"isBoolean",value:function isBoolean(_boolean){return Util.isType(_boolean,"boolean")}},{key:"isString",value:function isString(string){return Util.isType(string,"string")}},{key:"isNumber",value:function isNumber(number){return Util.isType(number,"number")}},{key:"isSymbol",value:function isSymbol(symbol){return Util.isType(symbol,"symbol")}},{key:"isObject",value:function isObject(object){return Util.isType(object,"object")}},{key:"isArray",value:function isArray(array){return Array.isArray(array)}}]);return Util}();var ValueStore=function(){var ValueStore=function(){function ValueStore(){_classCallCheck(this,ValueStore);this.values=new Map;this.valueRefGenerator=new RefGenerator("val")}_createClass(ValueStore,[{key:"useValue",value:function useValue(value,appName){var _this=this;if(Util.isFunction(value)){value=value(value)}var ref=this.valueRefGenerator.next();this.values.set(ref,value);var getter=function getter(){return _this.values.get(ref)};var setter=function setter(next,update){if(Util.isFunction(next)){next=next(getter())}_this.values.set(ref,next);if(update!==false){RMEAppManager.getOrDefault(appName).refresh()}};return[getter,setter]}}]);return ValueStore}();var RefGenerator=function(){function RefGenerator(feed){_classCallCheck(this,RefGenerator);this.feed=feed||"";this.seq=0}_createClass(RefGenerator,[{key:"next",value:function next(){var ref=this.feed+this.seq;this.seq++;return ref}}]);return RefGenerator}();var valueStore=new ValueStore;return valueStore}();var createApp=function(){var matchSelector=function matchSelector(key){var match=key.match(/#[a-zA-Z-0-9\-]+/);if(!match){match=key.match(/\.[a-zA-Z-0-9\-]+/)}return match?match.join():undefined};return function(template){if(!Util.isObject(template)){throw new Error("The app creation template must be an object.")}var selector=matchSelector(Object.keys(template).shift());if(Util.isEmpty(selector)){throw new Error("The root selector could not be parsed from the template. Selector should be type an #id or a .class")}return RMEAppBuilder.root(selector).create(Object.values(template).shift())}}();var useValue=function(){return function(value,appName){return ValueStore.useValue(value,appName)}}();var RMEAppManager=function(){var seq=0;var prefix="app";var _useValue=useValue({}),_useValue2=_slicedToArray(_useValue,2),getFrom=_useValue2[0],setTo=_useValue2[1];var set=function set(name,value){return setTo(function(store){return _objectSpread(_objectSpread({},store),{},_defineProperty({},name,value))},false)};var get=function get(name){return getFrom()[name]};var getOrDefault=function getOrDefault(name){return Util.notEmpty(name)?get(name):get("".concat(prefix,"0"))};var getAll=function getAll(){return Object.values(getFrom())};var createName=function createName(){while(Util.notEmpty(get(prefix+seq))){seq++}return prefix+seq};return{set:set,get:get,getAll:getAll,createName:createName,getOrDefault:getOrDefault}}();var RMEAppBuilder=function(){var holder={appRoot:undefined};var Builder=function(){function Builder(){_classCallCheck(this,Builder)}_createClass(Builder,null,[{key:"root",value:function root(_root){holder.appRoot=Util.isString(_root)&&_root;return Builder}},{key:"reset",value:function reset(){holder.appRoot=undefined;return Builder}},{key:"create",value:function create(object){if(!(RMETemplateResolver.isTemplate(object)||RMETemplateFragmentHelper.isFragment(object))){throw new Error("App template must start with a valid html tag or a fragment key")}var app=new AppInstance(RMEAppManager.createName(),holder.appRoot,object);RMEAppManager.set(app.name,app);Builder.reset();return app}}]);return Builder}();var AppInstance=function(){function AppInstance(name,root,object){_classCallCheck(this,AppInstance);this.rawStage=object;this.name=name;this.root;this.renderer;this.oldStage="";this.ready=false;this.refreshQueue;this.bindReadyListener(root)}_createClass(AppInstance,[{key:"bindReadyListener",value:function bindReadyListener(root){var _this2=this;["loading","interactive"].includes(document.readyState)?ready(function(){return _this2.init(root)}):this.init(root)}},{key:"init",value:function init(root){this.root=Util.isEmpty(root)?Tree.getBody():new RMETemplateElement(Tree.getFirst(root).dom());this.renderer=new RMEElemRenderer(this.root);this.ready=true;this.refresh()}},{key:"refresh",value:function refresh(){var _this3=this;if(this.ready){if(this.refreshQueue){Browser.clearTimeout(this.refreshQueue)}this.refreshQueue=Browser.setTimeout(function(){var freshStage=RMETemplateResolver.resolve(_defineProperty({},_this3.root.toLiteralString(),_objectSpread({},_this3.rawStage)),null,_this3.name);if(_this3.oldStage!==freshStage.toString()){_this3.oldStage=_this3.renderer.merge(freshStage).toString()}Browser.clearTimeout(_this3.refreshQueue)})}}}]);return AppInstance}();return{root:Builder.root,create:Builder.create}}();var RMEElemRenderer=function(){function RMEElemRenderer(root){_classCallCheck(this,RMEElemRenderer);this.root=root;this.mergedStage;this.pendingRemove=[]}_createClass(RMEElemRenderer,[{key:"merge",value:function merge(newStage){this.root.updateListeners(newStage);var oldChildren=this.root.children;var newChildren=newStage.children;var i=0;while(i<newChildren.length||i<oldChildren.length){this.render(this.root,oldChildren[i],newChildren[i],i);i++}this.clearPending();return this.root}},{key:"render",value:function render(parent,oldNode,newNode,index){if(!oldNode&&newNode){parent.append(newNode.duplicate())}else if(oldNode&&!newNode){this.pendingRemove.push({parent:parent,child:oldNode,index:index})}else if(oldNode.getTagName()!==newNode.getTagName()){oldNode.setParams(newNode.attributes,newNode.listeners);oldNode.replace(index,parent,newNode)}else{if(!!oldNode&&!!newNode&&oldNode.getTagName()===newNode.getTagName()&&!oldNode.equals(newNode)){oldNode.setProps(newNode.getPropsObj());oldNode.updateListeners(newNode);oldNode.updateAttributes(newNode);oldNode.removeDetachedChildren(newNode)}var i=0;var oldLength=oldNode?oldNode.children.length:0;var newLength=newNode?newNode.children.length:0;while(i<newLength||i<oldLength){this.render(parent.children[index],oldNode?oldNode.children[i]:null,newNode?newNode.children[i]:null,i);i++}}}},{key:"clearPending",value:function clearPending(){if(this.pendingRemove.length>0){var lastIdx=this.pendingRemove.length-1;while(lastIdx>=0){this.pendingRemove[lastIdx].parent.remove(this.pendingRemove[lastIdx].index,this.pendingRemove[lastIdx].child);lastIdx--}this.pendingRemove.length=0}}}]);return RMEElemRenderer}();var Browser=function(){function Browser(){_classCallCheck(this,Browser)}_createClass(Browser,null,[{key:"setTimeout",value:function setTimeout(callback,milliseconds){for(var _len=arguments.length,params=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){params[_key-2]=arguments[_key]}return window.setTimeout(callback,milliseconds,params)}},{key:"clearTimeout",value:function clearTimeout(timeoutObject){window.clearTimeout(timeoutObject)}},{key:"setInterval",value:function setInterval(callback,milliseconds){for(var _len2=arguments.length,params=new Array(_len2>2?_len2-2:0),_key2=2;_key2<_len2;_key2++){params[_key2-2]=arguments[_key2]}return window.setInterval(callback,milliseconds,params)}},{key:"clearInterval",value:function clearInterval(intervalObject){window.clearInterval(intervalObject)}},{key:"toBase64",value:function toBase64(string){return window.btoa(string)}},{key:"fromBase64",value:function fromBase64(string){return window.atob(string)}},{key:"scrollTo",value:function scrollTo(xPos,yPos){window.scrollTo(xPos,yPos)}},{key:"scrollBy",value:function scrollBy(xPx,yPx){window.scrollBy(xPx,yPx)}},{key:"open",value:function open(url,name,specs,replace){return window.open(url,name,specs,replace)}},{key:"close",value:function close(openedWindow){openedWindow.close()}},{key:"print",value:function print(){window.print()}},{key:"alert",value:function alert(message){window.alert(message)}},{key:"confirm",value:function confirm(message){return window.confirm(message)}},{key:"prompt",value:function prompt(message,defaultText){return window.prompt(message,defaultText)}},{key:"mediaMatcher",value:function mediaMatcher(mediaString){if(mediaString.indexOf("(")!==0)mediaString="("+mediaString;if(mediaString.indexOf(")")!==mediaString.length-1)mediaString=mediaString+")";return window.matchMedia(mediaString)}},{key:"pageBack",value:function pageBack(){history.back()}},{key:"pageForward",value:function pageForward(){history.forward()}},{key:"pageGo",value:function pageGo(numberOfPagesOrUrl){history.go(numberOfPagesOrUrl)}},{key:"pushState",value:function pushState(stateObject,title,newURL){history.pushState(stateObject,title,newURL)}},{key:"replaceState",value:function replaceState(stateObject,title,newURL){history.replaceState(stateObject,title,newURL)}},{key:"newPage",value:function newPage(newURL){location.assign(newURL)}},{key:"reloadPage",value:function reloadPage(force){location.reload(force)}},{key:"replacePage",value:function replacePage(newURL){location.replace(newURL)}},{key:"getAnchorHash",value:function getAnchorHash(){return location.hash}},{key:"setAnchorHash",value:function setAnchorHash(hash){location.hash=hash}},{key:"getHostnamePort",value:function getHostnamePort(){return location.host}},{key:"setHostnamePort",value:function setHostnamePort(hostPort){location.host=hostPort}},{key:"getHostname",value:function getHostname(){return location.hostname}},{key:"setHostname",value:function setHostname(hostname){location.hostname=hostname}},{key:"getURL",value:function getURL(){return location.href}},{key:"setURL",value:function setURL(newURL){location.href=newURL}},{key:"getOrigin",value:function getOrigin(){return location.origin}},{key:"getPathname",value:function getPathname(){return location.pathname}},{key:"setPathname",value:function setPathname(pathname){location.pathname=pathname}},{key:"getPort",value:function getPort(){return location.port}},{key:"setPort",value:function setPort(portNumber){location.port=portNumber}},{key:"getProtocol",value:function getProtocol(){return location.protocol}},{key:"setProtocol",value:function setProtocol(protocol){location.protocol=protocol}},{key:"getSearchString",value:function getSearchString(){return location.search}},{key:"setSearchString",value:function setSearchString(searchString){location.search=searchString}},{key:"getCodename",value:function getCodename(){return navigator.appCodeName}},{key:"getName",value:function getName(){return navigator.appName}},{key:"getVersion",value:function getVersion(){return navigator.appVersion}},{key:"isCookiesEnabled",value:function isCookiesEnabled(){return navigator.cookieEnabled}},{key:"getGeoLocation",value:function getGeoLocation(){return navigator.geolocation}},{key:"getLanguage",value:function getLanguage(){return navigator.language}},{key:"getPlatform",value:function getPlatform(){return navigator.platform}},{key:"getProduct",value:function getProduct(){return navigator.product}},{key:"getUserAgentHeader",value:function getUserAgentHeader(){return navigator.userAgent}},{key:"getColorDepth",value:function getColorDepth(){return screen.colorDepth}},{key:"getFullScreenHeight",value:function getFullScreenHeight(){return screen.height}},{key:"getFullScreenWidth",value:function getFullScreenWidth(){return screen.width}},{key:"getAvailableScreenHeight",value:function getAvailableScreenHeight(){return screen.availHeight}},{key:"getAvailableScreenWidth",value:function getAvailableScreenWidth(){return screen.availWidth}}]);return Browser}();var RMEAppComponent=function(){function RMEAppComponent(renderHook,appName,parentContext){_classCallCheck(this,RMEAppComponent);this.store=useValue({},appName);this.appName=appName;this.parentContext=parentContext;this.shouldUpdate=true;this.renderHook=renderHook;this.afterRenderTasks=[];this.prevProps={};this.prevResult}_createClass(RMEAppComponent,[{key:"render",value:function render(props,parent,componentLiteral){var _this4=this;var _this$store=_slicedToArray(this.store,2),getState=_this$store[0],setState=_this$store[1];var nextProps=_objectSpread(_objectSpread({},props),getState());var ops={setState:setState,updateState:function updateState(next,update){setState(function(state){return _objectSpread(_objectSpread({},state),Util.isFunction(next)?next(getState()):next)},update)},isStateEmpty:function isStateEmpty(){return Object.keys(getState()).length===0},shouldComponentUpdate:function shouldComponentUpdate(shouldUpdateHook){if(Util.isFunction(shouldUpdateHook)){_this4.shouldUpdate=shouldUpdateHook(nextProps,_this4.prevProps)!==false}},asyncTask:function asyncTask(asyncTaskHook){if(Util.isFunction(asyncTaskHook)){_this4.afterRenderTasks.push(asyncTaskHook)}}};var result;if(this.shouldUpdate){result=this.renderHook(nextProps,ops);result=RMETemplateResolver.isTemplate(result)?RMETemplateResolver.resolve(result,parent,this.appName,this.parentContext,componentLiteral):result}else{result=this.prevResult}this.prevResult=result;this.prevProps=nextProps;if(this.afterRenderTasks.length>0){Browser.setTimeout(_asyncToGenerator(_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_this4.afterRenderTasks.forEach(function(){var _ref2=_asyncToGenerator(_regeneratorRuntime().mark(function _callee(hook){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",hook());case 1:case"end":return _context.stop()}},_callee)}));return function(_x2){return _ref2.apply(this,arguments)}}());_this4.afterRenderTasks.length=0;case 2:case"end":return _context2.stop()}},_callee2)})))}return result}}]);return RMEAppComponent}();var Component=function(){var resolveComponent=function resolveComponent(component){if(Util.isFunction(component)){RMEComponentManagerV2.addComponent(component.valueOf().name,component)}};return function(){for(var _len3=arguments.length,components=new Array(_len3),_key3=0;_key3<_len3;_key3++){components[_key3]=arguments[_key3]}components.forEach(function(component){return!Util.isEmpty(component.valueOf().name)&&resolveComponent(component)});return components.length===1?components[0]:components}}();var RMEComponentManagerV2=function(){var RMEComponentManager=function(){function RMEComponentManager(){_classCallCheck(this,RMEComponentManager);this.componentFunctionMap={};this.componentInstanceMap={}}_createClass(RMEComponentManager,[{key:"hasComponent",value:function hasComponent(name){return this.componentFunctionMap[name]!==undefined}},{key:"addComponent",value:function addComponent(name,renderHook){if(!this.hasComponent(name)){this.componentFunctionMap[name]=renderHook}}},{key:"getComponent",value:function getComponent(name,props,parent,componentLiteral){var parentContext=arguments.length>4&&arguments[4]!==undefined?arguments[4]:"";var appName=arguments.length>5&&arguments[5]!==undefined?arguments[5]:"";var component=this.componentInstanceMap[appName+name+parentContext];if(!component){component=new RMEAppComponent(this.componentFunctionMap[name],appName,parentContext);this.componentInstanceMap[appName+name+parentContext]=component}return component.render(props,parent,componentLiteral)}}]);return RMEComponentManager}();return new RMEComponentManager}();var CSS=function(){var getStyles=function getStyles(config){var styles=Tree.getHead().getByTag("style");if(Util.isEmpty(config)&&!Util.isArray(styles)){return styles}else if(Util.isArray(styles)){return styles.find(function(style){return arePropertiesSame(style.getProps(),config)})}else if(!Util.isEmpty(styles)&&arePropertiesSame(styles.getProps(),config)){return styles}};var propsWithoutContent=function propsWithoutContent(props){var newProps=_objectSpread({},props);delete newProps.text;return newProps};var arePropertiesSame=function arePropertiesSame(oldProps,newProps){return JSON.stringify(propsWithoutContent(oldProps))===JSON.stringify(newProps||{})};var hasStyles=function hasStyles(config){return!Util.isEmpty(getStyles(config))};var hasContent=function hasContent(content,config){var styles=getStyles(config);if(!Util.isEmpty(styles)){return styles.getContent().match(content)!==null}};return function(content,config){if(!hasStyles(config)){Tree.getHead().append(RMETemplateResolver.resolve({style:_objectSpread({content:content},config)}))}else if(!hasContent(content,config)){var style=getStyles(config);if(!Util.isEmpty(style)){var prevContent=style.getContent();style.setContent(prevContent+content)}}}}();var Elem=function(){function Elem(type){_classCallCheck(this,Elem);if(Util.isString(type)){this.html=document.createElement(type)}else if(type.nodeType!==undefined&&type.ownerDocument!==undefined&&type.nodeType>=1&&type.ownerDocument instanceof Document){this.html=type}else{throw"type must be a string or a Document"}}_createClass(Elem,[{key:"setText",value:function setText(text){if(this.html.hasChildNodes()){this.html.replaceChild(document.createTextNode(text),this.html.childNodes[0])}else{this.html.appendChild(document.createTextNode(text))}return this}},{key:"getText",value:function getText(){var text="";this.html.childNodes.forEach(function(node){if(node.nodeType===3){text=node.nodeValue}});return text}},{key:"getContent",value:function getContent(){return this.html.innerHTML}},{key:"setContent",value:function setContent(html){this.html.innerHTML=html;return this}},{key:"setValue",value:function setValue(value){this.html.value=value;return this}},{key:"getValue",value:function getValue(){return this.html.value}},{key:"setId",value:function setId(id){this.html.id=id;return this}},{key:"getId",value:function getId(){return this.html.id}},{key:"append",value:function append(elem){elem&&this.html.appendChild(elem.dom());return this}},{key:"remove",value:function remove(elem){this.html.removeChild(elem.dom());return this}},{key:"replace",value:function replace(newElem){this.html.parentElement.replaceChild(newElem.dom(),this.html);return this}},{key:"before",value:function before(newElem){this.html.parentElement.insertBefore(newElem.dom(),this.html);return this}},{key:"after",value:function after(newElem){if(this.html.nextElementSibling!==null)this.html.parentElement.insertBefore(newElem.dom(),this.html.nextElementSibling);else this.html.parentElement.appendChild(newElem.dom());return this}},{key:"toString",value:function toString(){return"<"+this.getTagName().toLowerCase()+">"+this.getContent()+"</"+this.getTagName().toLowerCase()+">"}},{key:"toLiteralString",value:function toLiteralString(){return RMEElemTemplater.toLiteralString(this)}},{key:"toTemplate",value:function toTemplate(deep){return RMEElemTemplater.toTemplate(this,deep)}},{key:"getProps",value:function getProps(json){if(json===true)return JSON.stringify(RMEElemTemplater.getElementProps(this));else return RMEElemTemplater.getElementProps(this)}},{key:"setProps",value:function setProps(props){RMETemplateResolver.updateElemProps(this,props,this.getProps());return this}},{key:"render",value:function render(){var newState=[];var i=0;for(var _len4=arguments.length,elems=new Array(_len4),_key4=0;_key4<_len4;_key4++){elems[_key4]=arguments[_key4]}var max=elems.length;while(i<max){if(Util.isArray(elems[i]))newState=newState.concat(elems[i]);else newState.push(elems[i]);i++}if(!Elem.RenderHelper.isNewStateEqualToPrevState(newState)){Elem.RenderHelper.setPrevState(null);while(this.html.firstChild){this.html.removeChild(this.html.firstChild)}i=0;max=newState.length;while(i<max){if(!Util.isEmpty(newState[i]))this.append(newState[i]);i++}}Elem.RenderHelper.setPrevState(newState);return this}},{key:"getChildren",value:function getChildren(){return Elem.wrapElems(this.html.children)}},{key:"get",value:function get(selector){return Elem.wrapElems(this.html.querySelectorAll(selector))}},{key:"getFirst",value:function getFirst(selector){try{return Elem.wrap(this.html.querySelector(selector))}catch(e){}}},{key:"getByTag",value:function getByTag(tag){return Elem.wrapElems(this.html.getElementsByTagName(tag))}},{key:"getByClass",value:function getByClass(classname){return Elem.wrapElems(this.html.getElementsByClassName(classname))}},{key:"setTitle",value:function setTitle(text){this.html.title=text;return this}},{key:"getTitle",value:function getTitle(){return this.html.title}},{key:"setTabIndex",value:function setTabIndex(idx){this.setAttribute("tabindex",idx);return this}},{key:"getTabIndex",value:function getTabIndex(){return this.getAttribute("tabindex")}},{key:"getTagName",value:function getTagName(){return this.html.tagName}},{key:"setAttribute",value:function setAttribute(attr,value){var attribute=document.createAttribute(attr);attribute.value=value;this.html.setAttributeNode(attribute);return this}},{key:"getAttribute",value:function getAttribute(attr){return this.html.getAttribute(attr)}},{key:"removeAttribute",value:function removeAttribute(attr){var attrNode=this.html.getAttributeNode(attr);if(attrNode)this.html.removeAttributeNode(attrNode);return this}},{key:"setName",value:function setName(name){this.setAttribute("name",name);return this}},{key:"getName",value:function getName(){return this.getAttribute("name")}},{key:"setType",value:function setType(type){this.setAttribute("type",type);return this}},{key:"getType",value:function getType(){return this.getAttribute("type")}},{key:"setSource",value:function setSource(source){this.setAttribute("src",source);return this}},{key:"getSource",value:function getSource(){return this.getAttribute("src")}},{key:"setHref",value:function setHref(href){this.setAttribute("href",href);return this}},{key:"getHref",value:function getHref(){return this.getAttribute("href")}},{key:"setPlaceholder",value:function setPlaceholder(placeholder){this.setAttribute("placeholder",placeholder);return this}},{key:"getPlaceholder",value:function getPlaceholder(){return this.getAttribute("placeholder")}},{key:"setSize",value:function setSize(size){this.setAttribute("size",size);return this}},{key:"getSize",value:function getSize(){return this.getAttribute("size")}},{key:"setMaxLength",value:function setMaxLength(length){this.setAttribute("maxlength",length);return this}},{key:"getMaxLength",value:function getMaxLength(){return this.getAttribute("maxlength")}},{key:"setMinLength",value:function setMinLength(length){this.setAttribute("minlength",length);return this}},{key:"getMinLength",value:function getMinLength(){return this.getAttribute("minlength")}},{key:"setData",value:function setData(key,value){this.html.dataset[key]=value;return this}},{key:"getData",value:function getData(key){return this.html.dataset[key]}},{key:"setEditable",value:function setEditable(_boolean2){this.setAttribute("contenteditable",_boolean2);return this}},{key:"getEditable",value:function getEditable(){return this.getAttribute("contenteditable")}},{key:"setDisabled",value:function setDisabled(_boolean3){if(Util.isBoolean(_boolean3)&&_boolean3===true||Util.isString(_boolean3)&&_boolean3==="disabled"){this.setAttribute("disabled","disabled")}else{this.removeAttribute("disabled")}return this}},{key:"getDisabled",value:function getDisabled(){return this.getAttribute("disabled")}},{key:"setChecked",value:function setChecked(_boolean4){if(Util.isBoolean(_boolean4)&&_boolean4===true||Util.isString(_boolean4)&&_boolean4==="checked"){this.setAttribute("checked","checked");this.html.checked=true}else{this.removeAttribute("checked");this.html.checked=false}return this}},{key:"getChecked",value:function getChecked(){return this.getAttribute("checked")}},{key:"setSelected",value:function setSelected(_boolean5){if(Util.isBoolean(_boolean5)&&_boolean5===true||Util.isString(_boolean5)&&_boolean5==="selected"){this.setAttribute("selected","selected")}else{this.removeAttribute("selected")}return this}},{key:"getSelected",value:function getSelected(){return this.getAttribute("selected")}},{key:"addClasses",value:function addClasses(classes){var addClassesArray=classes.trim().split(" ");var origClassName=this.getClasses();var origClassesArray=origClassName.split(" ");addClassesArray=addClassesArray.filter(function(clazz){return origClassName.match(clazz)===null});this.html.className=origClassesArray.concat(addClassesArray).join(" ").trim();return this}},{key:"updateClasses",value:function updateClasses(classes){this.addClasses(classes);var origClassName=this.getClasses();var origClassesArray=origClassName.split(" ");var updateClassesArray=[];classes.trim().split(" ").forEach(function(clazz){if(origClassesArray.filter(function(cl){return cl===clazz}).length>0)updateClassesArray.push(clazz)});this.html.className=updateClassesArray.join(" ").trim();return this}},{key:"removeClasses",value:function removeClasses(classes){var toRm=classes.trim().split(" ");var origClass="".concat(this.getClasses());var i=0;while(i<toRm.length){var clazz=toRm[i];if(origClass.match("".concat(clazz))!==null)origClass=origClass.replace(clazz,"").trim();i++}this.html.className=origClass.trim();return this}},{key:"toggleClasses",value:function toggleClasses(classes){var cArr=classes.split(" ");var origClass="".concat(this.getClasses());var toAdd="";var toRm="";var i=0;while(i<cArr.length){if(origClass.match("".concat(cArr[i]))!==null)toRm+=" "+cArr[i];else toAdd+=" "+cArr[i];i++}this.addClasses(toAdd.trim());this.removeClasses(toRm.trim());return this}},{key:"getClasses",value:function getClasses(){return this.html.className}},{key:"setStyles",value:function setStyles(styleMap){for(var style in styleMap){if(styleMap.hasOwnProperty(style))this.html.style[style]=styleMap[style]}return this}},{key:"getStyle",value:function getStyle(styleName){return this.html.style[styleName]}},{key:"setVisible",value:function setVisible(_boolean6){this.html.style.visibility=_boolean6?"":"hidden";return this}},{key:"display",value:function display(_boolean7){this.html.style.display=_boolean7?"":"none";return this}},{key:"setDraggable",value:function setDraggable(_boolean8){this.setAttribute("draggable",_boolean8);return this}},{key:"message",value:function message(_message){var i=0;var paramArray=[];for(var _len5=arguments.length,params=new Array(_len5>1?_len5-1:0),_key5=1;_key5<_len5;_key5++){params[_key5-1]=arguments[_key5]}while(i<params.length){if(Util.isArray(params[i]))paramArray=paramArray.concat(params[i]);else paramArray.push(params[i]);i++}this.setText(RMEMessagesResolver.message(_message,paramArray));return this}},{key:"click",value:function click(){var _this5=this;Browser.setTimeout(function(){return _this5.html.click()});return this}},{key:"focus",value:function focus(){var _this6=this;Browser.setTimeout(function(){return _this6.html.focus()});return this}},{key:"blur",value:function blur(){var _this7=this;Browser.setTimeout(function(){return _this7.html.blur()});return this}},{key:"clone",value:function clone(deep){return Elem.wrap(this.html.cloneNode(deep))}},{key:"dom",value:function dom(){return this.html}},{key:"duplicate",value:function duplicate(){return RMETemplateResolver.resolve(this.toTemplate())}},{key:"height",value:function height(){return this.html.height}},{key:"width",value:function width(){return this.html.width}},{key:"top",value:function top(){return this.html.offsetTop}},{key:"left",value:function left(){return this.html.offsetLeft}},{key:"parent",value:function parent(){return this.html.parentElement!==null?Elem.wrap(this.html.parentElement):null}},{key:"next",value:function next(){return this.html.nextElementSibling!==null?Elem.wrap(this.html.nextElementSibling):null}},{key:"previous",value:function previous(){return this.html.previousElementSibling!==null?Elem.wrap(this.html.previousElementSibling):null}},{key:"getFirstChild",value:function getFirstChild(){return this.html.firstElementChild!==null?Elem.wrap(this.html.firstElementChild):null}},{key:"getLastChild",value:function getLastChild(){return this.html.lastElementChild!==null?Elem.wrap(this.html.lastElementChild):null}},{key:"extend",value:function extend(child){child.prototype=this;child.prototype.constructor=child;return child}},{key:"onAnimationStart",value:function onAnimationStart(handler){this.html.onanimationstart=handler;return this}},{key:"onAnimationIteration",value:function onAnimationIteration(handler){this.html.onanimationiteration=handler;return this}},{key:"onAnimationEnd",value:function onAnimationEnd(handler){this.html.onanimationend=handler;return this}},{key:"onTransitionEnd",value:function onTransitionEnd(handler){this.html.ontransitionend=handler;return this}},{key:"onDrag",value:function onDrag(handler){this.html.ondrag=handler;return this}},{key:"onDragEnd",value:function onDragEnd(handler){this.html.ondragend=handler;return this}},{key:"onDragEnter",value:function onDragEnter(handler){this.html.ondragenter=handler;return this}},{key:"onDragOver",value:function onDragOver(handler){this.html.ondragover=handler;return this}},{key:"onDragStart",value:function onDragStart(handler){this.html.ondragstart=handler;return this}},{key:"onDrop",value:function onDrop(handler){this.html.ondrop=handler;return this}},{key:"onClick",value:function onClick(handler){this.html.onclick=handler;return this}},{key:"onDoubleClick",value:function onDoubleClick(handler){this.html.ondblclick=handler;return this}},{key:"onContextMenu",value:function onContextMenu(handler){this.html.oncontextmenu=handler;return this}},{key:"onMouseDown",value:function onMouseDown(handler){this.html.onmousedown=handler;return this}},{key:"onMouseEnter",value:function onMouseEnter(handler){this.html.onmouseenter=handler;return this}},{key:"onMouseLeave",value:function onMouseLeave(handler){this.html.onmouseleave=handler;return this}},{key:"onMouseMove",value:function onMouseMove(handler){this.html.onmousemove=handler;return this}},{key:"onMouseOver",value:function onMouseOver(handler){this.html.onmouseover=handler;return this}},{key:"onMouseOut",value:function onMouseOut(handler){this.html.onmouseout=handler;return this}},{key:"onMouseUp",value:function onMouseUp(handler){this.html.onmouseup=handler;return this}},{key:"onWheel",value:function onWheel(handler){this.html.onwheel=handler;return this}},{key:"onScroll",value:function onScroll(handler){this.html.onscroll=handler;return this}},{key:"onResize",value:function onResize(handler){this.html.onresize=handler;return this}},{key:"onError",value:function onError(handler){this.html.onerror=handler;return this}},{key:"onLoad",value:function onLoad(handler){this.html.onload=handler;return this}},{key:"onUnload",value:function onUnload(handler){this.html.onunload=handler;return this}},{key:"onBeforeUnload",value:function onBeforeUnload(handler){this.html.onbeforeunload=handler;return this}},{key:"onKeyUp",value:function onKeyUp(handler){this.html.onkeyup=handler;return this}},{key:"onKeyDown",value:function onKeyDown(handler){this.html.onkeydown=handler;return this}},{key:"onKeyPress",value:function onKeyPress(handler){this.html.onkeypress=handler;return this}},{key:"onInput",value:function onInput(handler){this.html.oninput=handler;return this}},{key:"onChange",value:function onChange(handler){this.html.onchange=handler;return this}},{key:"onSubmit",value:function onSubmit(handler){this.html.onsubmit=handler;return this}},{key:"onSelect",value:function onSelect(handler){this.html.onselect=handler;return this}},{key:"onReset",value:function onReset(handler){this.html.onreset=handler;return this}},{key:"onFocus",value:function onFocus(handler){this.html.onfocus=handler;return this}},{key:"onFocusIn",value:function onFocusIn(handler){this.html.onfocusin=handler;return this}},{key:"onFocusOut",value:function onFocusOut(handler){this.html.onfocusout=handler;return this}},{key:"onBlur",value:function onBlur(handler){this.html.onblur=handler;return this}},{key:"onCopy",value:function onCopy(handler){this.html.oncopy=handler;return this}},{key:"onCut",value:function onCut(handler){this.html.oncut=handler;return this}},{key:"onPaste",value:function onPaste(handler){this.html.onpaste=handler;return this}},{key:"onAbort",value:function onAbort(handler){this.html.onabort=handler;return this}},{key:"onWaiting",value:function onWaiting(handler){this.html.onwaiting=handler;return this}},{key:"onVolumeChange",value:function onVolumeChange(handler){this.html.onvolumechange=handler;return this}},{key:"onTimeUpdate",value:function onTimeUpdate(handler){this.html.ontimeupdate=handler;return this}},{key:"onSeeking",value:function onSeeking(handler){this.html.onseeking=handler;return this}},{key:"onSeekEnd",value:function onSeekEnd(handler){this.html.onseekend=handler;return this}},{key:"onRateChange",value:function onRateChange(handler){this.html.onratechange=handler;return this}},{key:"onProgress",value:function onProgress(handler){this.html.onprogress=handler;return this}},{key:"onLoadMetadata",value:function onLoadMetadata(handler){this.html.onloadmetadata=handler;return this}},{key:"onLoadedData",value:function onLoadedData(handler){this.html.onloadeddata=handler;return this}},{key:"onLoadStart",value:function onLoadStart(handler){this.html.onloadstart=handler;return this}},{key:"onPlaying",value:function onPlaying(handler){this.html.onplaying=handler;return this}},{key:"onPlay",value:function onPlay(handler){this.html.onplay=handler;return this}},{key:"onPause",value:function onPause(handler){this.html.onpause=handler;return this}},{key:"onEnded",value:function onEnded(handler){this.html.onended=handler;return this}},{key:"onDurationChange",value:function onDurationChange(handler){this.html.ondurationchange=handler;return this}},{key:"onCanPlay",value:function onCanPlay(handler){this.html.oncanplay=handler;return this}},{key:"onCanPlayThrough",value:function onCanPlayThrough(handler){this.html.oncanplaythrough=handler;return this}},{key:"onStalled",value:function onStalled(handler){this.html.onstalled=handler;return this}},{key:"onSuspend",value:function onSuspend(handler){this.html.onsuspend=handler;return this}},{key:"onPopState",value:function onPopState(handler){this.html.onpopstate=handler;return this}},{key:"onStorage",value:function onStorage(handler){this.html.onstorage=handler;return this}},{key:"onHashChange",value:function onHashChange(handler){this.html.onhashchange=handler;return this}},{key:"onAfterPrint",value:function onAfterPrint(handler){this.html.onafterprint=handler;return this}},{key:"onBeforePrint",value:function onBeforePrint(handler){this.html.onbeforeprint=handler;return this}},{key:"onPageHide",value:function onPageHide(handler){this.html.onpagehide=handler;return this}},{key:"onPageShow",value:function onPageShow(handler){this.html.onpageshow=handler;return this}}],[{key:"create",value:function create(type){return new Elem(type)}},{key:"wrap",value:function wrap(html){return new Elem(html)}},{key:"wrapElems",value:function wrapElems(htmlDoc){var wrapped=Array.from(htmlDoc).map(Elem.wrap);return wrapped.length===1?wrapped[0]:wrapped}}]);return Elem}();Elem.RenderHelper=function(){function RenderHelper(){_classCallCheck(this,RenderHelper);this.instance;this.prevState=[];this.prevStateString=""}_createClass(RenderHelper,null,[{key:"setPrevState",value:function setPrevState(state){RenderHelper.getInstance().prevState=state;RenderHelper.getInstance().prevStateString=Util.isEmpty(state)?"":state.toString()}},{key:"getPrevState",value:function getPrevState(){return RenderHelper.getInstance().prevState}},{key:"isNewStateEqualToPrevState",value:function isNewStateEqualToPrevState(newState){return RenderHelper.getInstance().prevStateString===newState.toString()}},{key:"getInstance",value:function getInstance(){if(!this.instance)this.instance=new RenderHelper;return this.instance}}]);return RenderHelper}();var RMEElemTemplater=function(){function RMEElemTemplater(){_classCallCheck(this,RMEElemTemplater);this.instance;this.template;this.deep=true}_createClass(RMEElemTemplater,[{key:"toTemplate",value:function toTemplate(elem,deep){if(Util.notEmpty(deep))this.deep=deep;this.resolve(elem,{});return this.template}},{key:"resolve",value:function resolve(elem,parent){var _this8=this;var resolved=this.resolveElem(elem,this.resolveProps(elem));Object.keys(parent).forEach(function(key){if(Util.isArray(parent[key]._)){parent[key]._.push(resolved)}else{_this8.extendMap(parent[key],resolved)}});var children=Array.of(elem.getChildren()).flat();if(children.length>0&&this.deep){children.forEach(function(child){return _this8.resolve(child,resolved)})}this.template=resolved}},{key:"extendMap",value:function extendMap(map,next){for(var v in next){if(next.hasOwnProperty(v)){map[v]=next[v]}}}},{key:"resolveElem",value:function resolveElem(elem,props){var el={};var children=elem.getChildren();if(Util.isArray(children)&&children.length>1){var elTag=elem.getTagName().toLowerCase();var elName=this.resolveId(elTag,props);elName=this.resolveClass(elName,props);elName=this.resolveAttrs(elName,props);el[elName]=_objectSpread(_objectSpread({},props),{},{_:[]})}else{el[elem.getTagName().toLowerCase()]=props}return el}},{key:"resolveId",value:function resolveId(tag,props){if(props.id)return tag+"#"+props.id;else return tag}},{key:"resolveClass",value:function resolveClass(tag,props){if(props["class"])return tag+"."+props["class"].replace(/ /g,".");else return tag}},{key:"resolveAttrs",value:function resolveAttrs(tag,props){var tagName=tag;for(var p in props){if(props.hasOwnProperty(p)&&p!=="id"&&p!=="class"&&p.indexOf("on")!==0){tagName+="[".concat(p,"=").concat(props[p],"]")}}return tagName}},{key:"resolveProps",value:function resolveProps(elem){var props={};var attributes=elem.dom().attributes;var a=0;if(attributes){while(a<attributes.length){props[this.resolveAttributeNames(attributes[a].name)]=attributes[a].value;a++}}if(elem.dom().hasChildNodes()&&elem.dom().childNodes[0].nodeType===3){props["text"]=elem.getText()}for(var p in elem.dom()){if(p.indexOf("on")!==0||Util.isEmpty(elem.dom()[p]))continue;else props[this.resolveListeners(p)]=elem.dom()[p]}return props}},{key:"resolveAttributeNames",value:function resolveAttributeNames(attrName){if(attrName.indexOf("data")===0&&attrName.length>"data".length){while(attrName.search("-")>-1){attrName=attrName.replace(/-\w/,attrName.charAt(attrName.search("-")+1).toUpperCase())}return attrName}else if(attrName.indexOf("aria")===0){return attrName.replace(attrName.charAt("aria".length),attrName.charAt("aria".length).toUpperCase())}else{return attrName}}},{key:"resolveListeners",value:function resolveListeners(name){switch(name){case"onanimationstart":return"onAnimationStart";case"onanimationiteration":return"onAnimationIteration";case"onanimationend":return"onAnimationEnd";case"ontransitionend":return"onTransitionEnd";case"ondrag":return"onDrag";case"ondragend":return"onDragEnd";case"ondragenter":return"onDragEnter";case"ondragover":return"onDragOver";case"ondragstart":return"onDragStart";case"ondrop":return"onDrop";case"onclick":return"onClick";case"ondblclick":return"onDoubleClick";case"oncontextmenu":return"onContextMenu";case"onmousedown":return"onMouseDown";case"onmouseenter":return"onMouseEnter";case"onmouseleave":return"onMouseLeave";case"onmousemove":return"onMouseMove";case"onmouseover":return"onMouseOver";case"onmouseout":return"onMouseOut";case"onmouseup":return"onMouseUp";case"onwheel":return"onWheel";case"onscroll":return"onScroll";case"onresize":return"onResize";case"onerror":return"onError";case"onload":return"onLoad";case"onunload":return"onUnload";case"onbeforeunload":return"onBeforeUnload";case"onkeyup":return"onKeyUp";case"onkeydown":return"onKeyDown";case"onkeypress":return"onKeyPress";case"oninput":return"onInput";case"onchange":return"onChange";case"onsubmit":return"onSubmit";case"onselect":return"onSelect";case"onreset":return"onReset";case"onfocus":return"onFocus";case"onfocusin":return"onFocusIn";case"onfocusout":return"onFocusOut";case"onblur":return"onBlur";case"oncopy":return"onCopy";case"oncut":return"onCut";case"onpaste":return"onPaste";case"onabort":return"onAbort";case"onwaiting":return"onWaiting";case"onvolumechange":return"onVolumeChange";case"ontimeupdate":return"onTimeUpdate";case"onseeking":return"onSeeking";case"onseekend":return"onSeekEnd";case"onratechange":return"onRateChange";case"onprogress":return"onProgress";case"onloadmetadata":return"onLoadMetadata";case"onloadeddata":return"onLoadedData";case"onloadstart":return"onLoadStart";case"onplaying":return"onPlaying";case"onplay":return"onPlay";case"onpause":return"onPause";case"onended":return"onEnded";case"ondurationchange":return"onDurationChange";case"oncanplay":return"onCanPlay";case"oncanplaythrough":return"onCanPlayThrough";case"onstalled":return"onStalled";case"onsuspend":return"onSuspend";case"onpopstate":return"onPopState";case"onstorage":return"onStorage";case"onhashchange":return"onHashChange";case"onafterprint":return"onAfterPrint";case"onbeforeprint":return"onBeforePrint";case"onpagehide":return"onPageHide";case"onpageshow":return"onPageShow"}}},{key:"toLiteralString",value:function toLiteralString(elem){var props=this.resolveProps(elem);var string=this.resolveId(elem.getTagName().toLowerCase(),props);string=this.resolveClass(string,props);string=this.resolveAttrs(string,props);return string}}],[{key:"toTemplate",value:function toTemplate(elem,deep){return RMEElemTemplater.getInstance().toTemplate(elem,deep)}},{key:"getElementProps",value:function getElementProps(elem){return RMEElemTemplater.getInstance().resolveProps(elem)}},{key:"toLiteralString",value:function toLiteralString(elem){return RMEElemTemplater.getInstance().toLiteralString(elem)}},{key:"getInstance",value:function getInstance(){if(!this.instance)this.instance=new RMEElemTemplater;return this.instance}}]);return RMEElemTemplater}();var Fetch=function(){var Fetch=function(){function Fetch(){_classCallCheck(this,Fetch)}_createClass(Fetch,[{key:"get",value:function get(url,contentType){return this["do"]({url:url,init:{method:"GET"},contentType:getDefaultContentType(contentType)})}},{key:"post",value:function post(url,body,contentType){return this["do"]({url:url,body:body,init:{method:"POST"},contentType:getDefaultContentType(contentType)})}},{key:"put",value:function put(url,body,contentType){return this["do"]({url:url,body:body,init:{method:"PUT"},contentType:getDefaultContentType(contentType)})}},{key:"delete",value:function _delete(url,contentType){return this["do"]({url:url,init:{method:"DELETE"},contentType:getDefaultContentType(contentType)})}},{key:"patch",value:function patch(url,body,contentType){var _this$do;return this["do"]((_this$do={url:url},_defineProperty(_this$do,"url",url),_defineProperty(_this$do,"body",body),_defineProperty(_this$do,"init",{method:"PATCH"}),_defineProperty(_this$do,"contentType",getDefaultContentType(contentType)),_this$do))}},{key:"do",value:function _do(config){if(Util.isEmpty(config)||!Util.isObject(config)||Util.isEmpty(config.url)){throw new Error("Error in fetch config object ".concat(JSON.stringify(config),", url must be set"))}if(!config.init)config.init={};if(config.contentType&&config.contentType!=="buffer"){if(!config.init.headers)config.init.headers=new Headers({});if(!config.init.headers.has("Content-Type"))config.init.headers.set("Content-Type",config.contentType)}if((config.body||config.init.body)&&isContentType(config.contentType,Http.JSON)){config.init.body=JSON.stringify(config.body||config.init.body)}else if(config.body){config.init.body=config.body}if(config.method){config.init.method=config.method}return fetch(config.url,config.init).then(function(){var _ref3=_asyncToGenerator(_regeneratorRuntime().mark(function _callee3(response){var res;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(response.ok){_context3.next=2;break}throw Error("Error in requesting url: ".concat(config.url,", method: ").concat(config.init.method));case 2:if(!isContentType(config.contentType,Http.JSON)){_context3.next=7;break}_context3.next=5;return response.text();case 5:res=_context3.sent;return _context3.abrupt("return",res.length>0?JSON.parse(res):res);case 7:if(!isContentType(config.contentType,Http.TEXT_PLAIN)){_context3.next=9;break}return _context3.abrupt("return",response.text());case 9:if(!isContentType(config.contentType,Http.FORM_DATA)){_context3.next=11;break}return _context3.abrupt("return",response.formData());case 11:if(!isContentType(config.contentType,Http.OCTET_STREAM)){_context3.next=13;break}return _context3.abrupt("return",response.blob());case 13:if(!(config.contentType==="buffer")){_context3.next=15;break}return _context3.abrupt("return",response.arrayBuffer());case 15:return _context3.abrupt("return",response);case 16:case"end":return _context3.stop()}},_callee3)}));return function(_x3){return _ref3.apply(this,arguments)}}())}}]);return Fetch}();var isContentType=function isContentType(contentTypeA,contentTypeB){return Util.notEmpty(contentTypeA)&&contentTypeA.search(contentTypeB)>-1};var getDefaultContentType=function getDefaultContentType(contentType){if(contentType===undefined){return Http.JSON}else if(contentType===null){return null}else{return contentType}};return new Fetch}();var Http=function(){var Http=function(){function Http(config){_classCallCheck(this,Http);config.contentType=config.contentType===undefined?Http.JSON:config.contentType;if(window.Promise){this.self=new HttpPromiseAjax(config).instance()}else{this.self=new HttpAjax(config)}}_createClass(Http,[{key:"instance",value:function instance(){return this.self}}],[{key:"get",value:function get(url,requestContentType){return new Http({method:"GET",url:url,data:undefined,contentType:requestContentType}).instance()}},{key:"post",value:function post(url,data,requestContentType){return new Http({method:"POST",url:url,data:data,contentType:requestContentType}).instance()}},{key:"put",value:function put(url,data,requestContentType){return new Http({method:"PUT",url:url,data:data,contentType:requestContentType}).instance()}},{key:"delete",value:function _delete(url,requestContentType){return new Http({method:"DELETE",url:url,data:undefined,contentType:requestContentType}).instance()}},{key:"patch",value:function patch(url,data,requestContentType){return new Http({method:"PATCH",url:url,data:data,contentType:requestContentType}).instance()}},{key:"do",value:function _do(config){return new Http(config).instance()}}]);return Http}();Http.JSON="application/json";Http.FORM_DATA="multipart/form-data";Http.TEXT_PLAIN="text/plain";Http.OCTET_STREAM="application/octet-stream";var HttpAjax=function(){function HttpAjax(config){_classCallCheck(this,HttpAjax);this.config=config;this.data=isContentTypeJson(config.contentType)?JSON.stringify(config.data):config.data;this.xhr=new XMLHttpRequest;this.xhr.open(config.method,config.url);if(config.contentType)this.xhr.setRequestHeader("Content-Type",config.contentType);if(config.headers)setXhrHeaders(this.xhr,config.headers)}_createClass(HttpAjax,[{key:"then",value:function then(successHandler,errorHandler){var _this9=this;this.xhr.onload=function(){_this9.xhr.responseJSON=tryParseJSON(_this9.xhr.responseText);isResponseOK(_this9.xhr.status)?successHandler(isContentTypeJson(_this9.config.contentType)?resolveResponse(_this9.xhr.response):_this9.xhr):errorHandler(_this9.xhr)};if(this.config.onProgress){this.xhr.onprogress=function(event){_this9.config.onProgress(event)}}if(this.config.onTimeout){this.xhr.ontimeout=function(event){_this9.config.onTimeout(event)}}this.xhr.onerror=function(){_this9.xhr.responseJSON=tryParseJSON(_this9.xhr.responseText);if(errorHandler)errorHandler(_this9.xhr)};this.data?this.xhr.send(this.data):this.xhr.send();return this}},{key:"catch",value:function _catch(errorHandler){var _this10=this;this.xhr.onerror=function(){_this10.xhr.responseJSON=tryParseJSON(_this10.xhr.responseText);if(errorHandler)errorHandler(_this10.xhr)}}}]);return HttpAjax}();var HttpPromiseAjax=function(){function HttpPromiseAjax(config){_classCallCheck(this,HttpPromiseAjax);this.promise=new Promise(function(resolve,reject){new HttpAjax(config).then(function(response){return resolve(response)},function(error){return reject(error)})})}_createClass(HttpPromiseAjax,[{key:"instance",value:function instance(){return this.promise}}]);return HttpPromiseAjax}();var resolveResponse=function resolveResponse(response){var resp=tryParseJSON(response);return Util.notEmpty(resp)?resp:response};var setXhrHeaders=function setXhrHeaders(xhr,headers){Object.keys(headers).forEach(function(header){return xhr.setRequestHeader(header,headers[header])})};var isResponseOK=function isResponseOK(status){return Boolean([200,201,202,203,204,205,206,207,208,226].find(function(num){return num===status}))};var isContentTypeJson=function isContentTypeJson(contentType){return contentType&&(Http.JSON.search(contentType.toLowerCase())>-1||contentType.toLowerCase().search(Http.JSON)>-1)};var tryParseJSON=function tryParseJSON(text){try{return JSON.parse(text)}catch(e){}};return Http}();var Key=_createClass(function Key(){_classCallCheck(this,Key)});Key.ENTER="Enter";Key.ESC="Escape";Key.TAB="Tab";Key.F1="F1";Key.F2="F2";Key.F3="F3";Key.F4="F4";Key.F5="F5";Key.F6="F6";Key.F7="F7";Key.F8="F8";Key.F9="F9";Key.F10="F10";Key.F11="F11";Key.F12="F12";Key.A="a";Key.B="b";Key.C="c";Key.D="d";Key.E="e";Key.F="f";Key.G="g";Key.H="h";Key.I="i";Key.J="j";Key.L="l";Key.M="m";Key.N="n";Key.O="o";Key.P="p";Key.Q="q";Key.R="r";Key.S="s";Key.T="t";Key.U="u";Key.V="v";Key.W="w";Key.X="x";Key.Y="y";Key.Z="z";Key.CAPS_LOCK="CapsLock";Key.NUM_LOCK="NumLock";Key.SCROLL_LOCK="ScrollLock";Key.PAUSE="Pause";Key.PRINT_SCREEN="PrintScreen";Key.PAGE_UP="PageUp";Key.PAGE_DOWN="PageDown";Key.END="End";Key.HOME="Home";Key.DELETE="Delete";Key.INSERT="Insert";Key.ALT="Alt";Key.CTRL="Control";Key.CONTEXT_MENU="ContextMenu";Key.OS="OS";Key.ALTGR="AltGraph";Key.SHIFT="Shift";Key.BACKSPACE="Backspace";Key.SECTION="\xA7";Key.ONE="1";Key.TWO="2";Key.THREE="3";Key.FOUR="4";Key.FIVE="5";Key.SIX="6";Key.SEVEN="7";Key.EIGHT="8";Key.NINE="9";Key.ZERO="0";Key.PLUS="+";Key.MINUS="-";Key.STAR="*";Key.SLASH="/";Key.ARROW_UP="ArrowUp";Key.ARROW_RIGHT="ArrowRight";Key.ARROW_DOWN="ArrowDown";Key.ARROW_LEFT="ArrowLeft";Key.COMMA=",";Key.DOT=".";var useMessages=function(){return function(locale,loader){if(Util.isFunction(loader)){RMEMessagesResolver.load(function(locale,setMessages){return setMessages(loader(locale))})}if(Util.isString(locale)||locale instanceof Event){RMEMessagesResolver.lang(locale)}return RMEMessagesResolver.locale()}}();var useMessage=function(){return function(key){for(var _len6=arguments.length,params=new Array(_len6>1?_len6-1:0),_key6=1;_key6<_len6;_key6++){params[_key6-1]=arguments[_key6]}return RMEMessagesResolver.message.apply(RMEMessagesResolver,[key].concat(params))}}();var RMEMessagesResolver=function(){var Messages=function(){function Messages(){var _this11=this;_classCallCheck(this,Messages);this.ins=this;this.messages=[];this.locale="";this.translated=[];this.load=function(){};this.messagesType;this.ready=false;ready(function(){_this11.ready=true;_this11.runTranslated()})}_createClass(Messages,[{key:"setLoad",value:function setLoad(loader){if(!Util.isFunction(loader)){throw new Error("Message loader must be a function")}this.load=loader}},{key:"setLocale",value:function setLocale(locale){this.locale=locale;return this}},{key:"setMessages",value:function setMessages(messages){if(Util.isArray(messages)){this.messagesType="array"}else if(Util.isObject(messages)){this.messagesType="map"}else{throw new Error("Given messages must be an array or an object")}this.messages=messages;this.runTranslated()}},{key:"getMessage",value:function getMessage(text){for(var _len7=arguments.length,params=new Array(_len7>1?_len7-1:0),_key7=1;_key7<_len7;_key7++){params[_key7-1]=arguments[_key7]}if(Util.isEmpty(params.flat(2))){return this.resolveMessage(text)}else{var msg=this.resolveMessage(text);return this.resolveParams(msg,params.flat(2))}}},{key:"resolveMessage",value:function resolveMessage(text){if(this.messagesType==="array"){return this.resolveMessagesArray(text)}else if(this.messagesType==="map"){return this.resolveMessagesMap(text)}}},{key:"resolveMessagesMap",value:function resolveMessagesMap(text){var msg=text;for(var i in this.messages){if(i===text){msg=this.messages[i];break}}return msg}},{key:"resolveMessagesArray",value:function resolveMessagesArray(text){var i=0;var msg=text;while(i<this.messages.length){if(Util.notEmpty(this.messages[i][text])){msg=this.messages[i][text];break}i++}return msg}},{key:"resolveParams",value:function resolveParams(msg,params){if(Util.notEmpty(msg)){params.forEach(function(param,i){return msg=msg.replace("{".concat(i,"}"),param)});return msg}}},{key:"runTranslated",value:function runTranslated(){if(this.ready){RMEAppManager.getAll().forEach(function(app){return app.refresh()})}}}],[{key:"locale",value:function locale(){return Messages.instance.locale}},{key:"lang",value:function lang(locale){var nextLocale;if(locale instanceof Event){locale.preventDefault();var el=Elem.wrap(locale.target);nextLocale=el.getHref()||el.getValue()||el.getText()}else if(Util.isString(locale)){nextLocale=locale}else{throw new Error("The parameter locale must be an instance of the Event or a string")}if(Util.notEmpty(nextLocale)){Messages.instance.setLocale(nextLocale).load.call(Messages.instance,Messages.locale(),Messages.instance.setMessages.bind(Messages.instance))}}},{key:"message",value:function message(text){for(var _len8=arguments.length,params=new Array(_len8>1?_len8-1:0),_key8=1;_key8<_len8;_key8++){params[_key8-1]=arguments[_key8]}return Messages.instance.getMessage(text,params)}},{key:"load",value:function load(loader){Messages.instance.setLoad(loader)}},{key:"instance",get:function get(){if(!this.ins)this.ins=new Messages;return this.ins}}]);return Messages}();return{lang:Messages.lang,message:Messages.message,load:Messages.load,locale:Messages.locale}}();var script=function(){var addScript=function addScript(elem){var scripts=Tree.getHead().getByTag("script");if(scripts.length>0){var lastScript=scripts[scripts.length-1];lastScript.after(elem)}else{Tree.getHead().append(elem)}};return function(source,options){if(Util.notEmpty(source)){addScript(RMETemplateResolver.resolve({script:_objectSpread({src:source},options)}))}}}();var ready=function(){var callbacks=[];document.addEventListener("readystatechange",function(){if(document.readyState==="complete"){callbacks.forEach(function(callback){return callback()});callbacks.length=0}});return function(callback){callbacks.push(callback)}}();var RMEHashRouter=function RMEHashRouter(props,_ref4){var asyncTask=_ref4.asyncTask,updateState=_ref4.updateState;var routes=props.routes,_props$url=props.url,url=_props$url===void 0?location.hash:_props$url,prevUrl=props.prevUrl,prevRoute=props.prevRoute,didChange=props.didChange,globalScrollTop=props.globalScrollTop,init=props.init;if(!routes){return null}if(!init){RMERouterContext.setRouter(routes,function(url){updateState({url:url,didChange:true})});asyncTask(function(){window.addEventListener("hashchange",function(){updateState({init:true,url:location.hash,didChange:true})})})}var route;if(url!==prevUrl){route=RMERouterUtils.findRoute(url,routes,RMERouterUtils.hashMatch);asyncTask(function(){updateState({prevUrl:url,prevRoute:route},false)})}else{route=prevRoute}if(Util.notEmpty(route)){if(Util.isFunction(route.onBefore)){route.onBefore(route)}if(Util.isFunction(route.onAfter)){asyncTask(function(){return route.onAfter(route)})}if(route.hide){location.href=prevUrl}if(didChange&&window.scrollY>0&&(route.scrolltop===true||route.scrolltop===undefined&&globalScrollTop)){scrollTo(0,0)}asyncTask(function(){return updateState({didChange:false},false)})}return{_:!!route?RMERouterUtils.resolveRouteElem(route.elem,route.props):null}};var RMEOnLoadUrlRouter=function RMEOnLoadUrlRouter(props,_ref5){var asyncTask=_ref5.asyncTask;var routes=props.routes;if(!routes){return null}var route=RMERouterUtils.findRoute(location.pathname,routes,RMERouterUtils.urlMatch);if(Util.notEmpty(route)){if(Util.isFunction(route.onBefore)){route.onBefore(route)}if(Util.isFunction(route.onAfter)){asyncTask(function(){return route.onAfter(route)})}}return{_:!!route?RMERouterUtils.resolveRouteElem(route.elem,route.props):null}};var RMEUrlRouter=function RMEUrlRouter(props,_ref6){var updateState=_ref6.updateState,asyncTask=_ref6.asyncTask;var routes=props.routes,url=props.url,prevUrl=props.prevUrl,prevRoute=props.prevRoute,skipPush=props.skipPush,init=props.init,didChange=props.didChange,globalScrollTop=props.globalScrollTop;if(!routes){return null}if(!init){var updateUrl=function updateUrl(url,skipPush,didChange){updateState({init:true,url:url?url:location.pathname,skipPush:skipPush,didChange:didChange})};RMERouterContext.setRouter(routes,function(url){return updateUrl(url,false,true)});asyncTask(function(){window.addEventListener("popstate",function(){return updateUrl(undefined,true,true)});updateUrl(undefined,true,true)})}var route;if(url!==prevUrl){route=RMERouterUtils.findRoute(url,routes,RMERouterUtils.urlMatch);asyncTask(function(){updateState({prevUrl:url,prevRoute:route},false)})}else{route=prevRoute}if(Util.notEmpty(route)){if(Util.isFunction(route.onBefore)){route.onBefore(route)}if(Util.isFunction(route.onAfter)){asyncTask(function(){return route.onAfter(route)})}if(!route.hide&&url!==prevUrl&&!skipPush){history.pushState(null,null,url)}if(didChange&&window.scrollY>0&&(route.scrolltop===true||route.scrolltop===undefined&&globalScrollTop)){scrollTo(0,0)}asyncTask(function(){return updateState({didChange:false},false)})}return{_:!!route?RMERouterUtils.resolveRouteElem(route.elem,route.props):null}};var RMERouterContext=function(){var RouterContext=function(){function RouterContext(){_classCallCheck(this,RouterContext);this.ins;this.routers=[]}_createClass(RouterContext,[{key:"set",value:function set(key,value){if(!!key&&!!value&&!this.has(key)){this.routers.push(_objectSpread({key:key},value))}}},{key:"has",value:function has(key){return!!this.routers.find(function(route){return route.key===key})}},{key:"get",value:function get(url){var found;var prevFoundRouter;if(url.match(/^\/[^#]/)||url==="/"){var urlRouters=this.routers.filter(function(router){return router.key.match(/^:\//)});found=urlRouters.find(function(router,idx){var route=RMERouterUtils.findRoute(url,router.routes,RMERouterUtils.urlMatch);if(!!route){prevFoundRouter=router}return!!route&&idx===urlRouters.length-1});found=found||prevFoundRouter}else{var hashRouters=this.routers.filter(function(router){return router.key.match(/^:#?/)});found=hashRouters.find(function(router,idx){var route=RMERouterUtils.findRoute(url,router.routes,RMERouterUtils.hashMatch);if(!!route){prevFoundRouter=router}return!!route&&idx===hashRouters.length-1});found=found||prevFoundRouter}return!!found?found.navigateHook:function(){return undefined}}}],[{key:"createContextKey",value:function createContextKey(routes){return":".concat(routes.map(function(route){return route.route}).join(":"))}},{key:"navigateTo",value:function navigateTo(url){RouterContext.instance.get(RMERouterUtils.getUrlPath(url))(url)}},{key:"setRouter",value:function setRouter(routes,navigateHook){RouterContext.instance.set(RouterContext.createContextKey(routes),{routes:routes,navigateHook:navigateHook})}},{key:"instance",get:function get(){if(!this.ins){this.ins=new RouterContext}return this.ins}}]);return RouterContext}();return RouterContext}();var RMERouterUtils=function(){var getUrlPath=function getUrlPath(url){return url.replace(/\:{1}\/{2}/,"").match(/\/{1}.*/).join()};var urlMatch=function urlMatch(oldUrl,newUrl){oldUrl=Util.isString(oldUrl)?oldUrl.replace(/\*/g,".*").replace(/\/{2,}/g,"/"):oldUrl;var path=getUrlPath(newUrl);var found=path.match(oldUrl);if(Util.notEmpty(found)){found=found.join()}return found===path&&new RegExp(oldUrl).test(newUrl)};var hashMatch=function hashMatch(oldUrl,newUrl){if(Util.isString(oldUrl)){oldUrl=oldUrl.replace(/\*/g,".*");if(oldUrl.charAt(0)!=="#"){oldUrl="#".concat(oldUrl)}}var hash=newUrl.match(/\#{1}.*/).join();var found=hash.match(oldUrl);found=Util.notEmpty(found)?found.join():null;return found===hash&&new RegExp(oldUrl).test(newUrl)};var findRoute=function findRoute(url,routes,matcherHook){return url&&routes.find(function(route){return matcherHook(route.route,url)})};var resolveRouteElem=function resolveRouteElem(elem,props){if(Util.isFunction(elem)&&RMEComponentManagerV2.hasComponent(elem.valueOf().name)){return _defineProperty({},elem.valueOf().name,props)}else if(Util.isString(elem)&&RMEComponentManagerV2.hasComponent(elem)){return _defineProperty({},elem,props)}else{return{_:elem.toTemplate()}}};return{getUrlPath:getUrlPath,findRoute:findRoute,urlMatch:urlMatch,hashMatch:hashMatch,resolveRouteElem:resolveRouteElem}}();var useHashRouter=function(){return function(routes){var scrollTop=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;Component(RMEHashRouter);return{RMEHashRouter:{routes:routes,globalScrollTop:scrollTop}}}}();var useOnLoadUrlRouter=function(){return function(routes){Component(RMEOnLoadUrlRouter);return{RMEOnLoadUrlRouter:{routes:routes}}}}();var useUrlRouter=function(){return function(routes){var scrollTop=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;Component(RMEUrlRouter);return{RMEUrlRouter:{routes:routes,globalScrollTop:scrollTop}}}}();var useRouter=function(){return function(url){if(Util.isString(url)){RMERouterContext.navigateTo(url)}else if(url instanceof Event){url.preventDefault();RMERouterContext.navigateTo(url.target.href)}}}();var RMETemplateElement=function(_Elem){_inherits(RMETemplateElement,_Elem);var _super=_createSuper(RMETemplateElement);function RMETemplateElement(type){var _this12;_classCallCheck(this,RMETemplateElement);_this12=_super.call(this,type);_this12.props={};_this12.stringProps;_this12.listeners=[];_this12.attributes=[];_this12.attributeString="";_this12.listenerObj={};_this12.listenerString="";_this12.children=[];_this12.inlineProps={};return _this12}_createClass(RMETemplateElement,[{key:"hasListeners",value:function hasListeners(){return this.listeners.length>0}},{key:"updateListeners",value:function updateListeners(elem){var _this13=this;if(elem.hasListeners()){elem.listeners.forEach(function(listener){_this13[listener.parentProp.name].call(_this13,listener.func)});RMETemplateElement.Util.setListeners(this,elem.listeners)}}},{key:"removeDetachedChildren",value:function removeDetachedChildren(elem){var _this14=this;if(elem.children.length===0){this.children.forEach(function(child,idx){if(child.dom().parentElement===null){_this14.children.splice(idx,1)}})}}},{key:"setParams",value:function setParams(){var attrs=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var listeners=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];RMETemplateElement.Util.setAttributes(this,attrs);RMETemplateElement.Util.setListeners(this,listeners);RMETemplateElement.Util.formProps(this)}},{key:"updateAttributes",value:function updateAttributes(elem){RMETemplateElement.Util.setAttributes(this,elem.attributes,true);this.inlineProps=elem.inlineProps;RMETemplateElement.Util.formProps(this)}},{key:"setId",value:function setId(id){_get(_getPrototypeOf(RMETemplateElement.prototype),"setId",this).call(this,id);this.inlineProps.id=id;RMETemplateElement.Util.formProps(this);return this}},{key:"addClasses",value:function addClasses(classes){_get(_getPrototypeOf(RMETemplateElement.prototype),"addClasses",this).call(this,classes);this.inlineProps["class"]=_get(_getPrototypeOf(RMETemplateElement.prototype),"getClasses",this).call(this);RMETemplateElement.Util.formProps(this);return this}},{key:"addInlineAttr",value:function addInlineAttr(key,val){this.inlineProps[key]=val;RMETemplateElement.Util.formProps(this)}},{key:"append",value:function append(element){this.children.push(element);_get(_getPrototypeOf(RMETemplateElement.prototype),"append",this).call(this,element);return this}},{key:"remove",value:function remove(index,element){this.children.splice(index,1);_get(_getPrototypeOf(RMETemplateElement.prototype),"remove",this).call(this,element);return this}},{key:"replace",value:function replace(index,parent,element){parent.children.splice(index,1,element);this.inlineProps=element.inlineProps;RMETemplateElement.Util.formProps(element);_get(_getPrototypeOf(RMETemplateElement.prototype),"replace",this).call(this,element);return this}},{key:"setProps",value:function setProps(props){RMETemplateElement.Util.updateBrowserSetStyle(this,props);RMETemplateResolver.updateElemProps(this,props,this.props);return this}},{key:"equals",value:function equals(other){return this.stringProps===other.stringProps&&this.listenerString===other.listenerString}},{key:"getPropsString",value:function getPropsString(){return this.stringProps}},{key:"getPropsObj",value:function getPropsObj(){return this.props}},{key:"duplicate",value:function duplicate(){return RMETemplateElement.Util.duplicateElem(this)}}]);return RMETemplateElement}(Elem);RMETemplateElement.Util=function(){function RMETemplateElementUtil(){_classCallCheck(this,RMETemplateElementUtil)}_createClass(RMETemplateElementUtil,null,[{key:"duplicateElem",value:function duplicateElem(elem){var dup=new RMETemplateElement(elem.getTagName().toLowerCase());dup.inlineProps=elem.inlineProps;dup.setParams(elem.attributes,elem.listeners);RMETemplateResolver.updateElemProps(dup,elem.props,elem.props);if(elem.children.length>0){elem.children.map(function(child){return RMETemplateElement.Util.duplicateElem(child)}).forEach(function(child){return dup.append(child)})}return dup}},{key:"setListeners",value:function setListeners(elem,listeners){if(listeners.length>0){elem.listeners=listeners;elem.listenerObj=listeners.reduce(function(prev,curr){prev[curr.parentProp.name]=curr.func;return prev},{});elem.listenerString=listeners.map(function(listener){return listener.parentProp.name}).join()}}},{key:"setAttributes",value:function setAttributes(elem,attrs,override){if(attrs.length>0||override){elem.attributes=attrs.filter(function(attr){if(attr.key!=="class"){return attr}});elem.attributeString=elem.attributes.map(function(attr){return"".concat(attr.key,":").concat(attr.val)}).join().trim()}}},{key:"formProps",value:function formProps(elem){var props=elem.attributes.reduce(function(prev,curr){prev[curr.key]=curr.val;return prev},_objectSpread(_objectSpread({},elem.inlineProps),elem.listenerObj));elem.props=props;elem.stringProps=JSON.stringify(props)}},{key:"updateBrowserSetStyle",value:function updateBrowserSetStyle(elem,props){var style=elem.getAttribute("style");if(style){props.style=style}}}]);return RMETemplateElementUtil}();var RMETemplateFragmentHelper=function(){var FRAGMENT_REGEXP=/^_+$/g;var RMETemplateFragmentHelper=function(){function RMETemplateFragmentHelper(){_classCallCheck(this,RMETemplateFragmentHelper)}_createClass(RMETemplateFragmentHelper,[{key:"getFragmentKey",value:function getFragmentKey(template){return Object.keys(template).find(this.isFragmentKey)}},{key:"resolveFragmentValue",value:function resolveFragmentValue(template,templateValue){var fragmentKey=this.getFragmentKey(template);return template[fragmentKey]||template.fragment||templateValue}},{key:"isFragment",value:function isFragment(template){return Util.notEmpty(template)&&(template==="fragment"||Boolean(this.getFragmentKey(template)))}},{key:"isFragmentKey",value:function isFragmentKey(key){return key.match(FRAGMENT_REGEXP)||key.indexOf("fragment")===0}}]);return RMETemplateFragmentHelper}();return new RMETemplateFragmentHelper}();var RMETemplateResolver=function(){var Template=function(){function Template(){_classCallCheck(this,Template);this.template={};this.root=null;this.appName;this.context}_createClass(Template,[{key:"setTemplateAndResolve",value:function setTemplateAndResolve(template,parent){var appName=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";var context=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"";var componentLiteral=arguments.length>4?arguments[4]:undefined;this.template=template;this.appName=appName;this.context=context;if(parent){this.root=parent;if(componentLiteral){var key=Object.keys(this.template).shift();this.template=_defineProperty({},"".concat(key).concat(componentLiteral),this.template[key])}this.resolveNextParent(this.template,this.root,1)}else{this.resolveRootAndTemplate();this.resolveNextParent(this.template,this.root,1)}return this.root}},{key:"resolveRootAndTemplate",value:function resolveRootAndTemplate(){var key=Object.keys(this.template).shift();this.root=Template.resolveStringNumber(this.resolveElement(key,this.template),this.template);if(Util.isFunction(this.template[key])){this.template=this.template[key].call(this.root,this.root)}else{this.template=this.template[key]}}},{key:"resolveTemplateProperties",value:function resolveTemplateProperties(template,parent){var attrs=[];var listeners=[];var children=[];if(Util.isString(template)||Util.isNumber(template)){if(Util.isString(template)&&Template.isMessage(template)){attrs.push({key:"message",val:template})}else{attrs.push({key:"text",val:template})}}else if(Util.isArray(template)){template.forEach(function(obj){var key=Object.keys(obj).shift();var val=Object.values(obj).shift();children.push({key:key,val:Template.isComponent(key)&&Util.isFunction(val)?{}:val})})}else if(Util.isObject(template)){Object.keys(template).forEach(function(key,i){if(Template.isAttr(key,parent)){attrs.push({key:key,val:template[key]})}else if(Template.isEventKeyVal(key,template[key])){listeners.push({parentProp:parent[key],func:template[key]})}else if(Template.isTag(Template.getElementName(key))){children.push({key:key,val:template[key]})}else if(Template.isComponent(key)){children.push({key:key,val:!Util.isFunction(template[key])?template[key]:{}})}else if(RMETemplateFragmentHelper.isFragmentKey(key)){children.push({key:key,val:template[key]})}})}parent.setParams(attrs,listeners);return[attrs,listeners,children]}},{key:"resolveTemplate",value:function resolveTemplate(template,parent,round,parentContext){var _this15=this;var _this$resolveTemplate=this.resolveTemplateProperties(template,parent),_this$resolveTemplate2=_slicedToArray(_this$resolveTemplate,3),attrs=_this$resolveTemplate2[0],listeners=_this$resolveTemplate2[1],children=_this$resolveTemplate2[2];attrs.forEach(function(attr){return Template.resolveAttributes(parent,attr.key,_this15.resolveFunctionValue(attr.val,parent))});listeners.forEach(function(listener){return _this15.bindEventToElement(parent,listener.func,listener.parentProp)});children.forEach(function(rawChild,idx){if(RMETemplateFragmentHelper.isFragmentKey(rawChild.key)){_this15.resolveNextParent(rawChild.val,parent,round,parentContext+rawChild.key)}else{_this15.resolveChild(rawChild.key,rawChild.val,parent,round,idx,parentContext)}});round++}},{key:"resolveChild",value:function resolveChild(key,val,parent,round,invoked){var parentContext=arguments.length>5&&arguments[5]!==undefined?arguments[5]:"";var name=Template.getElementName(key);if(RMEComponentManagerV2.hasComponent(name)){var component=RMEComponentManagerV2.getComponent(name,this.resolveComponentLiteralVal(val),parent,this.cutComponentLiteral(name,key),"".concat(parentContext).concat(round).concat(invoked),this.appName);if(RMETemplateFragmentHelper.isFragment(component)&&Util.notEmpty(component)){this.resolveNextParent(RMETemplateFragmentHelper.resolveFragmentValue(component,val),parent,round)}}else{var child=Template.resolveStringNumber(this.resolveElement(key,val),val);parent.append(child);this.resolveNextParent(val,child,round,parentContext)}}},{key:"cutComponentLiteral",value:function cutComponentLiteral(name,key){return key.match("[^".concat(name,"].*"))}},{key:"resolveComponentLiteralVal",value:function resolveComponentLiteralVal(val){if(Util.isString(val)&&Template.isMessage(val)){return{message:val}}else if(Util.isString(val)||Util.isNumber(val)){return{text:val}}else{return val}}},{key:"resolveNextParent",value:function resolveNextParent(obj,parent,round){var _this16=this;var parentContext=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"";var arr=Array.of(this.resolveFunctionValue(obj,parent)).flat();var parentTag=Util.isEmpty(parent)?parentContext:parentContext+parent.getTagName().toLowerCase();arr.forEach(function(item,i){return _this16.resolveTemplate(item,parent,round,"".concat(_this16.context).concat(parentTag,"[").concat(i,"]"))})}},{key:"bindEventToElement",value:function bindEventToElement(elemInstance,sourceFunction,targetFunction){targetFunction.call(elemInstance,sourceFunction)}},{key:"resolveFunctionValue",value:function resolveFunctionValue(value,parent){return Util.isFunction(value)?value.call(parent,parent):value}},{key:"resolveElement",value:function resolveElement(tag,obj){var resolved=null;var match=[];var el=Template.getElementName(tag);if(Util.isString(el)&&Template.isTag(el)){resolved=new RMETemplateElement(el)}else{resolved=obj}match=tag.match(/[a-z0-9]+\#[a-zA-Z0-9\-]+/);if(!Util.isEmpty(match))resolved.setId(match.join().replace(/[a-z0-9]+\#/g,""));match=this.cutAttributesIfFound(tag).match(/\.[a-zA-Z-0-9\-]+/g);if(!Util.isEmpty(match))resolved.addClasses(match.join(" ").replace(/\./g,""));match=tag.match(/\[[a-zA-Z0-9\= \:\(\)\#\-\_\/\.&%@!?£$+¤|;\\<\\>\\{}"]+\]/g);if(!Util.isEmpty(match))resolved=Template.addAttributes(resolved,match);return resolved}},{key:"cutAttributesIfFound",value:function cutAttributesIfFound(tag){return tag.replace(/\[.+\]/g,"")}}],[{key:"resolveStringNumber",value:function resolveStringNumber(elem,value){if(Util.isString(value)&&Template.isMessage(value)){Template.resolveMessage(elem,value)}else if(Util.isString(value)||Util.isNumber(value)){elem.setText(value)}return elem}},{key:"isMessage",value:function isMessage(message){message=Template.normalizeMessageString(message);return Util.notEmpty(RMEMessagesResolver.message(message))&&RMEMessagesResolver.message(message)!=message}},{key:"addAttributes",value:function addAttributes(elem,attrArray){var i=0;var start="[";var eq="=";var end="]";while(i<attrArray.length){var attr=attrArray[i];var key=attr.substring(attr.indexOf(start)+1,attr.indexOf(eq));var val=attr.substring(attr.indexOf(eq)+1,attr.indexOf(end));Template.resolveAttributes(elem,key,val);elem.addInlineAttr(key,val);i++}return elem}},{key:"resolveAttributes",value:function resolveAttributes(elem,key,val){switch(key){case"id":elem.setId(val);break;case"class":elem.addClasses(val||"");break;case"text":elem.setText(val);break;case"message":Template.resolveMessage(elem,val);break;case"placeholder":Template.resolvePlaceholder(elem,key,val);break;case"content":Template.resolveContent(elem,key,val);break;case"tabIndex":elem.setTabIndex(val);break;case"editable":elem.setEditable(val);break;case"checked":elem.setChecked(val);break;case"disabled":elem.setDisabled(val);break;case"selected":elem.setSelected(val);break;case"visible":elem.setVisible(val);break;case"display":elem.display(val);break;case"styles":elem.setStyles(val);break;case"click":elem.click();break;case"focus":elem.focus();break;case"blur":elem.blur();break;case"maxLength":elem.setMaxLength(val);break;case"minLength":elem.setMinLength(val);break;default:Template.resolveDefault(elem,key,val)}}},{key:"resolvePlaceholder",value:function resolvePlaceholder(elem,key,val){var params=Template.getMessageParams(val);var message=Template.normalizeMessageString(val);elem.setAttribute(key,Template.isMessage(val)?RMEMessagesResolver.message(message,params):val)}},{key:"resolveDefault",value:function resolveDefault(elem,key,val){if(key.indexOf("data")===0&&key.length>"data".length)elem.setData(key.replace(/[A-Z]/,key.charAt(4).toLowerCase()).replace("data",""),val);else elem.setAttribute(key,val)}},{key:"resolveContent",value:function resolveContent(elem,key,val){if(elem.getTagName().toLowerCase()==="meta")elem.setAttribute(key,val);else elem.setContent(val)}},{key:"resolveMessage",value:function resolveMessage(elem,message){if(Util.isEmpty(message))throw"message must not be empty";elem.message(Template.normalizeMessageString(message),Template.getMessageParams(message))}},{key:"getMessageParams",value:function getMessageParams(message){var match=Template.getMessageParameterString(message);match=match&&match.join().replace(/({|}|:|;)/g,match.join()).split(match.join());return match&&match.filter(Util.notEmpty)}},{key:"getMessageParameterString",value:function getMessageParameterString(message){return message.match(/\:?(\{.*\}\;?)/g)}},{key:"normalizeMessageString",value:function normalizeMessageString(message){var params=Template.getMessageParameterString(message);return Util.notEmpty(params)?message.replace(params.join(),""):message}},{key:"isEventKeyVal",value:function isEventKeyVal(key,val){return key.indexOf("on")===0&&Util.isFunction(val)}},{key:"getElementName",value:function getElementName(str){if(Util.notEmpty(str))return str.match(/component:?[a-zA-Z0-9_]+|[a-zA-Z0-9_]+/).join()}},{key:"isComponent",value:function isComponent(key){return RMEComponentManagerV2.hasComponent(Template.getElementName(key))}},{key:"resolve",value:function resolve(template,parent,appName,context,componentLiteral){return Template.create().setTemplateAndResolve(template,parent,appName,context,componentLiteral)}},{key:"updateElemProps",value:function updateElemProps(elem,props,oldProps){var combined=Template.combineProps(props,oldProps);Object.entries(combined).forEach(function(_ref9){var _ref10=_slicedToArray(_ref9,2),prop=_ref10[0],value=_ref10[1];if(prop==="text"){value?elem.setText(value):elem.setText("")}else if(Template.isEventKeyVal(prop,value)){elem[prop].call(elem,value)}else if(prop==="class"){value?elem.updateClasses(value):elem.removeAttribute(prop)}else if(prop==="value"){value?elem.setAttribute(prop,value):elem.removeAttribute(prop);elem.setValue(value)}else if(prop==="tabIndex"){value?elem.setTabIndex(value):elem.removeAttribute("tabindex")}else if(prop==="editable"){value?elem.setEditable(value):elem.removeAttribute("contenteditable")}else if(prop==="maxLength"){value?elem.setMaxLength(value):elem.removeAttribute("maxlength")}else if(prop==="minLength"){value?elem.setMinLength(value):elem.removeAttribute("minlength")}else if(prop==="data"){value?elem.setAttribute(prop,value):elem.removeAttribute(prop)}else if(prop==="content"&&elem.getTagName().toLowerCase()==="meta"){value?elem.setAttribute(prop,value):elem.removeAttribute(prop)}else if(prop==="content"){elem.setContent(value)}else{value?Template.resolveAttributes(elem,prop,value):elem.removeAttribute(prop)}})}},{key:"combineProps",value:function combineProps(newProps,oldProps){Object.keys(oldProps).forEach(function(prop){if(oldProps[prop]&&!newProps[prop]){oldProps[prop]=undefined}});return _objectSpread(_objectSpread({},oldProps),newProps)}},{key:"create",value:function create(){return new Template}},{key:"isTemplate",value:function isTemplate(object){var isTemplate=false;if(Util.isObject(object)&&!Util.isArray(object)&&!(object instanceof RMETemplateElement)){for(var p in object){isTemplate=object.hasOwnProperty(p)&&Template.isTagOrComponent(p);if(isTemplate)break}}return isTemplate}},{key:"isTagOrComponent",value:function isTagOrComponent(tag){return Template.isComponent(tag)||Template.isTag(Template.getElementName(tag))}},{key:"isTag",value:function isTag(tag){var tags={a:["a","abbr","acronym","address","applet","area","article","aside","audio"],b:["button","br","b","base","basefont","bdi","bdo","big","blockquote","body"],c:["canvas","caption","center","cite","code","col","colgroup"],d:["div","dd","dl","dt","data","datalist","del","details","dfn","dialog"],e:["em","embed"],f:["form","fieldset","figcaption","figure","font","footer","frame","frameset"],h:["h1","h2","h3","h4","h5","h6","head","header","hr","html"],i:["i","input","img","iframe","ins"],k:["kbd"],l:["label","li","legend","link"],m:["main","meta","map","mark","meter"],n:["nav","noframes","noscript"],o:["option","object","ol","optgroup","output"],p:["p","pre","param","picture","progress"],q:["q"],r:["rp","rt","ruby"],s:["span","select","s","samp","script","section","small","source","strike","strong","style","sub","summary","sup","svg"],t:["table","textarea","td","tr","tt","th","thead","tbody","tfoot","template","time","title","track"],u:["u","ul"],v:["var","video"],w:["wbr"]};var i=0;var tagArray=tags[tag.charAt(0)];if(tagArray){while(i<tagArray.length){if(tagArray[i]===tag)return true;i++}}return false}},{key:"isAttr",value:function isAttr(key,elem){if(key==="span"&&Template.isElem(elem.getTagName(),["col","colgroup"]))return true;else if(key==="label"&&Template.isElem(elem.getTagName(),["track","option","optgroup"]))return true;else if(key==="title"&&(elem.parent()===null||elem.parent().getTagName().toLowerCase()!=="head"))return true;else if(key==="cite"&&Template.isElem(elem.getTagName(),["blockquote","del","ins","q"]))return true;else if(key==="form"&&Template.isElem(elem.getTagName(),["button","fieldset","input","label","meter","object","output","select","textarea"]))return true;else if(key.indexOf("data")===0&&(!RMEComponentManagerV2.hasComponent(key)&&!Template.isElem(elem.getTagName(),["data"])||Template.isElem(elem.getTagName(),["object"])))return true;var attrs={a:["alt","async","autocomplete","autofocus","autoplay","accept","accept-charset","accpetCharset","accesskey","action"],b:["blur"],c:["class","checked","content","contenteditable","crossorigin","crossOrigin","click","charset","cols","colspan","controls","coords"],d:["disabled","display","draggable","dropzone","datetime","default","defer","dir","dirname","download"],e:["editable","enctype"],f:["for","focus","formaction"],h:["href","height","hidden","high","hreflang","headers","http-equiv","httpEquiv"],i:["id","ismap"],k:["kind"],l:["lang","list","loop","low"],m:["message","max","maxlength","maxLength","min","minlength","minLength","multiple","media","method","muted"],n:["name","novalidate"],o:["open","optimum"],p:["placeholder","pattern","poster","preload"],r:["rel","readonly","required","reversed","rows","rowspan"],s:["src","size","selected","step","style","styles","shape","sandbox","scope","sizes","spellcheck","srcdoc","srclang","srcset","start"],t:["text","type","target","tabindex","tabIndex","translate"],u:["usemap"],v:["value","visible"],w:["width","wrap"]};var i=0;var keys=attrs[key.substring(0,1)];if(keys){while(i<keys.length){if(keys[i]===key)return true;i++}}if(Template.isAriaKey(key)){return true}return false}},{key:"isAriaKey",value:function isAriaKey(key){if(key.indexOf("aria")===0){var ariaKeys=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-braillelabel","aria-brailleroledescription","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colindextext","aria-colspan","aria-controls","aria-current","aria-describedby","aria-description","aria-details","aria-disabled","aria-dropeffect","aria-errormessage","aria-expanded","aria-flowto","aria-grabbed","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowindextext","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext"];var normalizedKey=Template.normalizeKey(key);return Boolean(ariaKeys.find(function(ariaKey){return ariaKey===normalizedKey}))}return false}},{key:"normalizeKey",value:function normalizeKey(key){var capital=key.search(/[A-Z]/);return capital>-1?"".concat(key.substring(0,capital),"-").concat(key.substr(capital).toLowerCase()):key}},{key:"isElem",value:function isElem(elemTag,array){var i=0;while(i<array.length){if(array[i]===elemTag.toLowerCase())return true;i++}return false}}]);return Template}();return Template}();var Tree=function(){function Tree(){_classCallCheck(this,Tree)}_createClass(Tree,null,[{key:"get",value:function get(selector){return Elem.wrapElems(document.querySelectorAll(selector))}},{key:"getFirst",value:function getFirst(selector){try{return Elem.wrap(document.querySelector(selector))}catch(e){}}},{key:"getByTag",value:function getByTag(tag){return Elem.wrapElems(document.getElementsByTagName(tag))}},{key:"getByName",value:function getByName(name){return Elem.wrapElems(document.getElementsByName(name))}},{key:"getById",value:function getById(id){try{return Elem.wrap(document.getElementById(id))}catch(e){}}},{key:"getByClass",value:function getByClass(classname){return Elem.wrapElems(document.getElementsByClassName(classname))}},{key:"getBody",value:function getBody(){try{return Elem.wrap(document.body)}catch(e){}}},{key:"getHead",value:function getHead(){try{return Elem.wrap(document.head)}catch(e){}}},{key:"getTitle",value:function getTitle(){return document.title}},{key:"setTitle",value:function setTitle(title){document.title=title}},{key:"getActiveElement",value:function getActiveElement(){try{return Elem.wrap(document.activeElement)}catch(e){}}},{key:"getAnchors",value:function getAnchors(){return Elem.wrapElems(document.anchors)}},{key:"getHtmlElement",value:function getHtmlElement(){return document.documentElement}},{key:"getDoctype",value:function getDoctype(){return document.doctype}},{key:"getEmbeds",value:function getEmbeds(){return Elem.wrapElems(document.embeds)}},{key:"getImages",value:function getImages(){return Elem.wrapElems(document.images)}},{key:"getLinks",value:function getLinks(){return Elem.wrapElems(document.links)}},{key:"getScripts",value:function getScripts(){return Elem.wrapElems(document.scripts)}},{key:"getForms",value:function getForms(){return Elem.wrapElems(document.forms)}}]);return Tree}();
